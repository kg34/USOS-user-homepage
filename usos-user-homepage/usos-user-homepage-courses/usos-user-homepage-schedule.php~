<?php
/*
 * Plugin Name: USOS user homepage schedule
 * Version: 1.0
 * Author: kg346915
 */


/**
 * Check for Wordpress Social Login
 */
function uuhs_activate(){

	//Require parent plugin
	if ( ! is_plugin_active( 'usos-user-homepage/usos-user-homepage.php' ) and current_user_can( 'activate_plugins' ) ) 
	{
		// Stop activation redirect and show error
		wp_die( 'Sorry, but this plugin requires the USOS User Homepage to be installed and active. <br><a href="' . admin_url( 'plugins.php' ) . '">&laquo; Return to Plugins</a>');
	}
}

/**
 * Attempt to install UHS upon activation
 * Create uuhs tables
 */

register_activation_hook( __FILE__, 'uuhs_activate' );

function uuhs_install()
{
	uuhs_database_install();
}

register_activation_hook( __FILE__, 'uuhs_install' );

function uuhs_uninstall()
{
	uuhs_database_uninstall();
}

register_deactivation_hook( __FILE__, 'uuhs_uninstall' );

defined( 'USOS_HOMEPAGE_SCHEDULE_ABS_PATH' )
	|| define( 'USOS_HOMEPAGE_SCHEDULE_ABS_PATH', WP_PLUGIN_DIR . '/usos-user-homepage-schedule' );
require_once( USOS_HOMEPAGE_SCHEDULE_ABS_PATH . '/includes/settings/uuhs.database.php' ); // Install/Uninstall WSL database tables

/**
 * Prevent from uninstalling the USOS User Homepage
 */

function uuhs_prevent_uuh_uninstall()
{
	wp_die( 'Sorry, but the USOS User Homepage is required to be installed and active by the USOS Homepage Schedule. You have to deactivate the USOS Homepage Schedule first. <br><a href="' . admin_url( 'plugins.php' ) . '">&laquo; Return to Plugins</a>');
}

register_deactivation_hook( WP_PLUGIN_DIR . '/usos-user-homepage/usos-user-homepage.php' , 'uuhs_prevent_uuh_uninstall' );

require_once( USOS_HOMEPAGE_SCHEDULE_ABS_PATH . '/uuhs-shortcode.php' );

?>
